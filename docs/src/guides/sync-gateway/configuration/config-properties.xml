<?xml version="1.0" encoding="UTF-8"?>
<article xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="../../../docs.xsd"
         id="config-properties">
   <title>Configuration using a configuration file</title>
   <description>An overview of Sync Gateway's configuration properties (for inclusion in a
      configuration file)</description>
   <related>
      <item><ref href="../configuration/command-line-options.xml">Configuration using command-line options</ref></item>
   </related>
   <introduction>
      <paragraph>You can use a configuration file to configure Sync Gateway. Configuration determines the runtime behavior of Sync Gateway, including server configuration and the database or set of databases with which a Sync Gateway instance can interact. All configuration properties have default values.</paragraph>
      <paragraph>Using a configuration file is the recommended approach for configuring Sync Gateway, because you can provide values for all configuration properties and you can define configurations for multiple Couchbase Server databases.</paragraph>
      <paragraph>When specifying a configuration file, the format of the <code>sync_gateway</code> command is:</paragraph>
      <code-block>
         sync_gateway [configuration file]
        </code-block>
      <paragraph>The following command starts Sync Gateway with the properties specified in the configuration file <code>config.json</code>:</paragraph>
      <code-block>
         $ sync_gateway config.json
      </code-block>
    </introduction>
    <topics>
       <topic id="configuration-files">
          <title>Configuration files</title>
          <body>
             <paragraph>A Sync Gateway configuration file is a JSON file that defines Sync Gateway's runtime behavior. When starting Sync Gateway, provide the path to the file as a command-line argument. Configuration properties are case-insensitive.</paragraph>
             <paragraph>Configuration files have one syntactic feature that is not standard JSON: any text between backticks (`) is treated as a string, even if it spans multiple lines or contains double-quotes. This makes it easy to embed JavaScript code, such as the sync and filter functions.</paragraph>
             <section id="config-file-example">
                <title>Example</title>
                <body>
             <paragraph>The following sample configuration file starts a server with the default settings:</paragraph>
             <code-block>
                {
                  "interface":":4984",        // Begin server configuration
                  "adminInterface":":4985",
                  "log":["REST"],
                  "databases":{               // Begin database configuration
                    "sync_gateway":{
                    "server":"http://localhost:8091",
                    "bucket":"sync_gateway",
                    "sync":`function(doc) {channel(doc.channels);}`
                    }
                  }
                }
             </code-block>
             <paragraph>You can see an example of a more complex configuration file in the <external-ref href="https://github.com/couchbaselabs/CouchChat-iOS/blob/master/sync-gateway-config.json">CouchChat-iOS sample app</external-ref>. Additional examples are in the <external-ref href="https://github.com/couchbase/sync_gateway/tree/master/examples">Sync Gateway Github examples repository</external-ref>.</paragraph>
                </body>
             </section>
          </body>
       </topic>
       <topic id="server-configuration">
          <title>Server configuration</title>
          <body>
             <paragraph>Configuration properties for server configuration are root-level configuration properties, for example:</paragraph>
             <code-block>
                {
                "interface":":4984",        // Begin server configuration
                "adminInterface":":4985",
                "log":["REST"]
                }
             </code-block>
             <paragraph>Following are configuration properties for configuration of the Sync Gateway server:</paragraph>
             <table>
                <header>
                   <row>
                      <entry>Property</entry>
                      <entry>Type</entry>
                      <entry>Description and default</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>adminInterface</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Port or TCP network address (IP address and the port) that the Admin REST API listens on. The default is <code>127.0.0.1:4985</code>.</entry>
                   </row>
                   <row>
                   <entry>
                      <code>adminUI</code>
                   </entry>
                      <entry><code>string</code></entry>
                      <entry>URL of the Sync Gateway Admin Console HTML page. The default is the bundled Sync Gateway Admin Console at <code>localhost:4985/_admin/</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>channel_index_writers</code>
                      </entry>
                      <entry>Array of configuration properties for distributed channel-index writers</entry>
                      <entry>Distributed channel-index writer settings. See <ref href="#writer-cluster-config">Disributed channel-index writer configuration</ref>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>compressResponses</code>
                      </entry>
                      <entry><code>Boolean</code></entry>
                      <entry>Whether to compress HTTP responses. Set to <code>false</code> to disable compression of HTTP responses. The default is <code>true</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>configServer</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>URL of a Couchbase database-configuration server (for dynamic database discovery).
                         <paragraph>A database-configuration server allows Sync Gateway to load a database configuration dynamically from a remote endpoint. If a database configuration server is defined, when Sync Gateway gets a request for a database that it doesn't know about, then Sync Gateway will attempt to retrieve the database configuration properties from the URL <code>ConfigServer/DBname</code>, where <code>DBname</code> is the database name. There is no default.</paragraph></entry>
                   </row>
                <row>
                   <entry>
                      <code>CORS</code>
                   </entry>
                   <entry>Array of CORS configuration properties</entry>
                   <entry>Configuration for allowing CORS (cross-origin resource sharing). There is no default. For more information, see <ref href="#cors-configuration">CORS configuration</ref>.</entry>
                </row>
                   <row>
                      <entry>
                         <code>CouchbaseKeepaliveInterval</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>TCP keep-alive interval in seconds between Sync Gateway and Couchbase Server. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>databases</code>
                      </entry>
                      <entry>Array of database configuration properties</entry>
                      <entry>Database settings. See <ref href="#database-configuration">Database configuration</ref>. There is no default.</entry>
                   </row>
                   <!-- Omitting deploymentID for the moment
                   <row>
                      <entry>
                         <code>deploymentID</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Optional customer/deployment ID for statistics reporting. There is no default.</entry>
                   </row>
                   -->
                   <row>
                      <entry>
                         <code>facebook</code>
                      </entry>
                      <entry>Array of Facebook configuration properties</entry>
                      <entry>Configuration for Facebook Login authentication. See <ref href="#facebook-configuration">Facebook configuration</ref>. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>interface</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Port or TCP network address (IP address and the port) that the Public REST API listens on. The default is <code>:4984</code>.</entry>
                   </row>
                  <row>
                     <entry>
                        <code>log</code>
                     </entry>
                     <entry><code>string</code></entry>
                     <entry>Comma-separated list of log keys to enable for diagnostic logging. Use <code>["*"]</code> to enable logging for all log keys. See <ref href="#log-keys">Log keys</ref>. The default is <code>HTTP</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>logFilePath</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Absolute or relative path on the filesystem to the log file. A relative path is from the directory that contains the Sync Gateway executable file. The default is <code>stderr</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>maxCouchbaseConnections</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum number of sockets to open to a Couchbase Server node. The default is <code>16</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>maxCouchbaseOverflow</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum number of overflow sockets to open. The default is no maximum.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>maxFileDescriptors</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum number of open file descriptors (RLIMIT_NOFILE). <emphasis>Not available on Windows.</emphasis> The default is <code>5000</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>maxHeartbeat</code>
                      </entry>
                      <entry>
                         <code>integer</code>
                      </entry>
                      <entry>Maximum heartbeat value for <code>_changes</code> feed requests (in seconds). The default is no maximum.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>maxIncomingConnections</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum number of incoming HTTP connections to accept. The default is no maximum.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>persona</code>
                      </entry>
                      <entry>Mozilla Persona configuration property</entry>
                      <entry>Configuration for Mozilla Persona authentication. See <ref href="#persona-configuration">Mozilla Persona configuration</ref>. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>pretty</code>
                      </entry>
                      <entry><code>Boolean</code></entry>
                      <entry>Whether to pretty-print JSON responses. The default is <code>false</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>profileInterface</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>TCP network address (IP address and the port) that the Go profile API listens on. You can obtain go profiling information from the interface. You can omit the IP address. There is no default.
                      </entry>
                   </row>
                   <row>
                      <entry>
                         <code>serverReadTimeout </code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum duration in seconds before timing out the read of an HTTP(S) request. The default is no timeout.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>serverWriteTimeout</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum duration in seconds before timing out the write of an HTTP(S) response. The default is no timeout.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>slowServerCallWarningThreshold</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Log warnings if database calls made by Sync Gateway take this many milliseconds or longer. The default is <emphasis>200 milliseconds</emphasis>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>SSLCert</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Absolute or relative path on the filesystem to the TLS certificate file, if TLS is used to secure Sync Gateway connections, or <code>"nil"</code> for plaintext. A relative path is from the directory that contains the Sync Gateway executable file. There is no default. For more information, see <ref href="../../sync-gateway/7-deployment-considerations.xml#transport-layer-security">Transport Layer Security (HTTPS)</ref>.
                      </entry>
                   </row>
                   <row>
                      <entry>
                         <code>SSLKey</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Absolute or relative path on the filesystem to the TLS private key file, if TLS is used to secure Sync Gateway connections, or <code>"nil"</code> for plaintext. A relative path is from the directory that contains the Sync Gateway executable file. There is no default.</entry>
                   </row>
                   <!-- Omitting for now
                   <row>
                      <entry>
                         <code>statsReportInterval</code>
                      </entry>
                      <entry><code>number</code></entry>
                      <entry>Optional statistics reporting interval in seconds. The number can be an integer, or a non-integer positive real number, expressed with a decimal point (for example, <code>2400.5</code>). Given realistic reporting intervals, integers are most likely. Set to <code>0</code> to disable. The default is <emphasis>3600 seconds (one hour)</emphasis>.</entry>
                   </row>
                   -->
                </body>
             </table>
          </body>
       </topic>
       
       <topic id="writer-cluster-config">
          <title>Distributed channel-index writer configuration</title>
          <body>
             <paragraph>Following are server configuration properties for the distributed channel-index writers (in the <code>channel_index_writers</code> array of configuration properties):</paragraph>
             <table>
                <header>
                   <row>
                      <entry>Property</entry>
                      <entry>Type</entry>
                      <entry>Description and default</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>bucket</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Name of the <emphasis>channel-indexing service configuration bucket</emphasis>, the bucket in which Sync Gateway instances that are channel-index writers store configuration data about themselves, for use by the channel-indexing service. There is no default.</entry>
                   </row> 
                   <row>
                      <entry>
                         <code>dataDir</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Full path of a local directory in which the channel-indexing service can persist some state data. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>heartbeatInterval</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>The heartbeat interval in seconds. Heartbeats are used to detect Sync Gateway instances that are down or otherwise not available. The default is <code>???</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>password</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Bucket password for authenticating to Couchbase Server. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>server</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>URL of the Couchbase server. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>username</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Bucket username for authenticating to Couchbase Server. There is no default.</entry>
                   </row>
                </body>
             </table>
             <paragraph>Also see <ref href="#channel-index-config">Channel-index bucket configuration</ref>.</paragraph>
             <paragraph>For more information about distributed channel indexing, see <ref href="../../sync-gateway/channel-index/guide.xml">Channel indexing</ref>.</paragraph>
          </body>
       </topic>
       
       <topic id="log-keys">
          <title>Log keys</title>
          <body>
             <paragraph>Log keys specify functional areas. Enabling logging for a log key provides additional diagnostic information for that area.</paragraph>
             <paragraph>Following are descriptions of the log keys that you can specify as a comma-separated list in the <code>Log</code> property. In some cases, a log key has two forms, one with a plus sign (<code>+</code>) suffix and one without, for example <code>CRUD+</code> and <code>CRUD</code>. The log key with the plus sign logs more verbosely. For example for <code>CRUD+</code>, the log contains all of the messages for <code>CRUD</code> and additional ones for <code>CRUD+</code>.</paragraph>
             <note>Log keys <emphasis>are</emphasis> case sensitive. Specify them as shown below.</note>
             <table>
                <header>
                   <row>
                      <entry>Log key</entry>
                      <entry>What is logged</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>Access</code>
                      </entry>
                      <entry><code>access()</code> calls made by the sync function</entry>
                   </row>
                <row>
                   <entry>
                      <code>Attach</code>
                   </entry>
                   <entry>Attachment processing</entry>
                </row>                
                <row>
                   <entry>
                      <code>Auth</code>
                   </entry>
                   <entry>Authentication</entry>
                </row>               
                <row>
                   <entry>
                      <code>Bucket</code>
                   </entry>
                   <entry>Sync Gateway interactions with the bucket (verbose logging).</entry>
                </row>                
                <row>
                   <entry>
                      <code>Cache</code> or <code>Cache+</code>
                   </entry>
                   <entry>Interactions with Sync Gateway's in-memory channel cache</entry>
                </row>                
                <row>
                   <entry>
                      <code>Changes</code> or <code>Changes+</code>
                   </entry>
                   <entry>Processing of <code>_changes</code> requests</entry>
                </row>               
                <row>
                   <entry>
                      <code>CRUD</code> or <code>CRUD+</code>
                   </entry>
                   <entry>Updates made by Sync Gateway to documents</entry>
                </row>
                <row>
                   <entry>
                      <code>DCP</code>
                   </entry>
                   <entry>DCP-feed processing (verbose logging)</entry>
                </row>
                <row>
                   <entry>
                      <code>Events</code> or <code>Events+</code>
                   </entry>
                   <entry>Event processing (webhooks)</entry>
                </row>
                <row>
                   <entry>
                      <code>Feed</code> or <code>Feed+</code>
                   </entry>
                   <entry>Server-feed processing</entry>
                </row>
                <row>
                   <entry>
                      <code>HTTP</code> or <code>HTTP+</code>
                   </entry>
                   <entry>All requests made to the Sync Gateway REST APIs (Sync and Admin). Note that the log keyword HTTP is always enabled, which means that HTTP requests and error responses are always logged (in a non-verbose manner). HTTP+ provides more verbose HTTP logging.</entry>
                </row>
                </body>
             </table>
          </body>
          </topic>
        
       <topic id="database-configuration">
          <title>Database configuration</title>
          <body>
             <paragraph>The <code>databases</code> configuration property specifies one or more mappings of database names to the configuration properties for each database. The Sync and Admin REST APIs refer to the database by this name. For example:</paragraph>
             <code-block>
                {
                  "databases":{               // Begin database configuration
                    "database1":{             // Name of this database
                       "server":"http://localhost:8091",     // Configuration properties that specify
                                                             // the onfiguration of this database
                       "bucket":"bucket",
                       "sync":`function(doc) {channel(doc.channels);}`
                    }
                  }
                }
             </code-block>
             <paragraph>In the example above, <code>database1</code> is the name of the database, and the configuration properties <code>server</code>, <code>bucket</code>, and <code>sync</code> are given values.</paragraph>
             <paragraph>Following are the configuration properties for a specific database:</paragraph>
             <table>
                <header>
                   <row>
                      <entry>Property</entry>
                      <entry>Type</entry>
                      <entry>Description and default</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>allowEmptyPassword</code>
                      </entry>
                      <entry><code>Boolean</code></entry>
                      <entry>Whether to allow empty passwords for Couchbase Server authentication. The default is <code>false</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>bucket</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Bucket name on Couchbase Server or a Walrus bucket. The default is the value of the property <code>Name</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>cacheConfig</code>
                      </entry>
                      <entry>Array of cache configuration properties</entry>
                      <entry>Cache settings. See <ref href="#cache-configuration">Cache configuration</ref>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>channel_index</code>
                      </entry>
                      <entry>Array of configuration properties for the channel-index for this database</entry>
                      <entry>Bucket settings for the channel-index bucket. See <ref href="#channel-index-config">Channel-index bucket configuration</ref>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>dcpShard</code>
                      </entry>
                      <entry>integer</entry>
                      <entry>Number of shards of the DCP feed. This configuration property applies solely if the distributed channel index is being used (The DCP-feed shards are distributed among channel-index writers. The number must be larger than the number of channel-index writers.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>eventHandlers</code>
                      </entry>
                      <entry><code>interface</code></entry>
                      <entry>Event handlers (for webhooks). There is no default. For more information, see <ref href="../integration/event-handling.xml">Using webhooks</ref>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>feedType</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Feed type: <code>DCP</code>, <code>TAP</code>, or <code>DCPSHARD</code>. Use the configuration property <code>DCPSHARD</code> to use distributed channel indexes for all of the Couchbase Server databases in a Couchbase cluster that Sync Gateway instances serve. The default is <code>TAP</code>.</entry>
                   </row>
                   <!-- I am omitting ImportDocs -->
                   <row>
                      <entry>
                         <code>offline</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Whether the database if kept offline when Sync Gateway starts. Specifying the value <code>true</code> results in the database being kept offline. The default (if the property is omitted) is to bring the database online when Sync Gateway starts. For more information, see <ref href="../../sync-gateway/administration/database-offline.xml">Taking databases offline and bringing them online</ref>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>password</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Bucket password for authenticating to Couchbase Server. There is no default.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>pool</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Couchbase pool name. The default is the string <code>default</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>revCacheSize</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Size of the revision cache, specified as the total number of document revisions to cache in memory for all recently accessed documents.
                         <paragraph>When the revision cache is full, Sync Gateway removes less recent document revisions to make room for new document revisions. Adjust this property to tune memory consumption by Sync Gateway, for example on servers with less memory and in cases when Sync Gateway creates many new documents and/or updates many documents relative to the number of read operations. The default is <code>5000</code>.</paragraph>
                      </entry>
                   </row>                         
                   <row>
                      <entry>
                         <code>revsLimit</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum depth to which a document's revision tree can grow
                         <note>If you use bucket shadowing, setting <code>revsLimit</code> to a value that is too small relative to the frequency of document revisions can have negative consequences. Bucket shadowing needs the revision history to be maintained until pending revisions are reconciled.</note>
                      </entry>
                   </row>
                   <row>
                      <entry>
                         <code>roles</code>
                      </entry>
                      <entry>Roles to create</entry>
                      <entry>Array of initial roles with their properties. There is no default.</entry>
                   </row>                 
                   <row>
                      <entry>
                         <code>server</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>URL of the Couchbase Server (or Walrus). The default is <code>walrus:</code>.</entry>
                   </row>
                   <!-- I am omitting bucket shadowing at the moment. -->
                   <row>
                      <entry>
                         <code>sync</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Sync function, which defines which users can read, update, or delete which documents. The default is a default sync function.
                         <paragraph>For more information, see the section <ref href="../../sync-gateway/4-sync-gateway-sync-function-api.xml">Sync function API</ref>.</paragraph></entry>
                   </row>
                <row>
                   <entry>
                      <code>username</code>
                   </entry>
                   <entry><code>string</code></entry>
                   <entry>Bucket username for authenticating to Couchbase Server. There is no default.</entry>
                </row>
                <row>
                   <entry>
                      <code>users</code>
                   </entry>
                   <entry>Users to create</entry>
                   <entry>Array of initial user accounts with their properties. There is no default.</entry>
                </row>
                </body>
             </table>
          </body>
       </topic>
       
       <topic id="channel-index-config">
          <title>Channel-index bucket configuration</title>
          <body>
             <paragraph>Following are configuration properties for the bucket for the distributed channel index for a database:</paragraph>
                   <table>
                      <header>
                         <row>
                            <entry>Property</entry>
                            <entry>Type</entry>
                            <entry>Description and default</entry>
                         </row>
                      </header>
                      <body>
                         <row>
                            <entry>
                               <code>bucket</code>
                            </entry>
                            <entry><code>string</code></entry>
                            <entry>Name of the bucket in which the channel index for the database is stored. There is no default.</entry>
                         </row> 
                         <row>
                            <entry>
                               <code>server</code>
                            </entry>
                            <entry><code>string</code></entry>
                            <entry>URL of the Couchbase Server. Their is no default.</entry>
                         </row>
                         <row>
                            <entry>
                               <code>writer</code>
                            </entry>
                            <entry><code>string</code></entry>
                            <entry>Whether the Sync Gateway instance acts as a channel-index writer for this database. Including <code>writer</code> with the value <code>true</code> makes this Sync Gateway instance a channel-index writer for this database. Omitting <code>"writer":true</code> means that the Sync Gateway instance will only read the channel index.</entry>
                         </row>
                      </body>
                   </table>
             <paragraph>The following sample configuration file includes configuration properties for the channel-index writer cluster and the channel-index bucket:</paragraph>
             <code-block>
                {
                    "interface":":4984",
                    "adminInterface":":4985",
                    "log":[
                    "*"
                    ],
                    "verbose":"true",
                    "cluster_config":{
                        "server":"http://localhost:8091",
                        "data_dir":"/tmp/sg",
                        "bucket":"channel_index"
                    },
                    "databases":{
                        "db":{
                            "feed_type":"DCPSHARD",
                            "num_shards":64
                           "server":"http://localhost:8091",
                           "revs_limit":300,
                           "users":{
                               "GUEST":{
                                   "disabled":true,
                                   "admin_channels":[
                                       "*"
                                   ]
                                }
                            },
                            "bucket":"default",
                             "channel_index":{
                                 "server":"http://channel_index@localhost:8091",
                                 "bucket":"channel_index",
                                 "writer":true
                             }
                         }
                     }
                 }
             </code-block>
             <paragraph>For more information about distributed channel indexing, see <ref href="../../sync-gateway/channel-index/guide.xml">Channel indexing</ref>.</paragraph>
                </body>
       </topic>
       
       <topic id="auth-configuration">
          <title>Authentication configuration</title>
          <body>
             <paragraph>Following are configuration properties for authentication:</paragraph>
             <section id="facebook-configuration">
                <title>Facebook configuration</title>
                <body>
                <paragraph>Following is the property that you can define for the server configuration property<code>facebook</code>:</paragraph>
                <table>
                   <header>
                      <row>
                         <entry>Property</entry>
                         <entry>Type</entry>
                         <entry>Description and default</entry>
                      </row>
                   </header>
                   <body>
                   <row>
                      <entry>
                         <code>register</code>
                      </entry>
                      <entry><code>Boolean</code></entry>
                      <entry>Whether the Facebook Login server will register new user accounts (<code>true</code> or <code>false</code>). The default is <code>false</code>.</entry>
                   </row>
                   </body>
             </table>
                <paragraph>For more information about Facebook authentication, see <ref href="../../sync-gateway/administration/authenticating-users.xml#facebook">Facebook authentication</ref>.</paragraph>
             </body>
         </section>
             <section id="persona-configuration">
                <title>Mozilla Persona configuration</title>
                <body>
                   <paragraph>Following are the properties that you can define for the server configuration property <code>persona</code>:</paragraph>
                   <table>
                      <header>
                         <row>
                            <entry>Property</entry>
                            <entry>Type</entry>
                            <entry>Description and default</entry>
                         </row>
                      </header>
                      <body>
                         <row>
                            <entry>
                               <code>origin</code>
                            </entry>
                            <entry><code>string</code></entry>
                            <entry>URL of Mozilla Persona Identity Provider (IdP) server for Persona authentication. There is no default.</entry>
                         </row>
                         <row>
                            <entry>
                               <code>register</code>
                            </entry>
                            <entry><code>Boolean</code></entry>
                            <entry>Whether the Mozilla Persona IdP server will register new user accounts (<code>true</code> or <code>false</code>). The default is <code>false</code>.</entry>
                         </row>
                      </body>
                   </table>
                   <paragraph>For more information about Mozilla Persona authentication, see <ref href="../../sync-gateway/administration/authenticating-users.xml#persona">Mozilla Persona authentication</ref>.</paragraph>
                </body>
             </section>
          </body>
       </topic>
       <topic id="cors-configuration">
          <title>CORS configuration</title>
          <body>
             <paragraph>Cross Origin Resource Sharing (CORS) is a browser security protocol that allows web pages to interact with resources hosted under domains other than their origin server.
                <external-ref href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">Read more about CORS.</external-ref></paragraph>
             <paragraph>Sync Gateway has server level configuration for CORS origin(s), headers, and max-age. It is also possible to use a wildcard <code>*</code> as the origin but wildcard matched domains won't send credentials. Don't use a wildcard if you can list the domains. The <code>Origin</code> list can include multiple entries. CORS is not enabled on the Sync Gateway admin port.</paragraph>
             <paragraph>The <code>LoginOrigin</code> list protects access to the <code>_session</code> and <code>_facebook</code> endpoints.</paragraph>
             <paragraph>A common use case is to sync with HTML5 apps running databases like <external-ref href="http://pouchdb.com/">PouchDB</external-ref>. It is also possible to interact directly with Sync Gateway from HTML5 applications via XHR, when CORS is configured.</paragraph>
             <paragraph>Following are configuration properties that you can define for CORS:</paragraph>
             <table>
                <header>
                   <row>
                      <entry>Property</entry>
                      <entry>Type</entry>
                      <entry>Description and default</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>origin</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Comma-separated list of allowed origins; use an asterisk (*) to allow access from everywhere. There is no default.</entry>
                   </row>
                <row>
                   <entry>
                      <code>loginOrigin</code>
                   </entry>
                   <entry><code>string</code></entry>
                   <entry>Comma-separated list of allowed login origins. There is no default.</entry>
                </row>
                <row>
                   <entry>
                      <code>headers</code>
                   </entry>
                   <entry><code>string</code></entry>
                   <entry>Comma-separated list of allowed HTTP headers. There is no default.</entry>
                </row>
                <row>
                   <entry>
                      <code>maxAge</code>
                   </entry>
                   <entry><code>integer</code></entry>
                   <entry>Value for the <code>Access-Control-Max-Age</code> header. This is the the number of seconds that the response to a CORS preflight request can be cached before sending another preflight request. There is no default.</entry>
                </row>
                </body>
             </table>
             <section id="cors-example">
                <title>Example</title>
                <body>
             <paragraph>The following configuration file starts a server with settings you might use when developing with Sync Gateway and PouchDB on the same laptop. Be sure to match the port number to your localhost webserver port. Guest has full access in this mode so you probably want to change this before you go into production.</paragraph>
             <code-block>
                {
                  "log": ["HTTP+"],
                  "CORS": {
                    "origin":["http://localhost:8000"],
                    "loginOrigin":["http://localhost:8000"],
                    "headers":["Content-Type"],
                    "maxAge": 1728000
                  },
                  "databases": {
                    "db": {
                      "server": "walrus:",
                      "users": { "GUEST": {"disabled": false, "admin_channels": ["*"] } }
                    }
                  }
                }
             </code-block>
                   <paragraph>You can find this example with a different <code>log</code> configuration property in the <external-ref href="https://github.com/couchbase/sync_gateway/tree/master/examples">Sync Gateway Github examples repository</external-ref>.</paragraph>
                </body>
             </section>
          </body>
       </topic>
       <topic id="event-configuration">
          <title>Webhook configuration</title>
          <body>
             <paragraph>Following are configuration properties for event handling and webhooks:</paragraph>
             <section id="event-handling">
                <title>Event handling</title>
                <body>
                   <paragraph>Following are properties that you can define for event handling:</paragraph>
             <table>
                <header>
                   <row>
                      <entry>Property</entry>
                      <entry>Type</entry>
                      <entry>Description and default</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>documentChanged</code>
                      </entry>
                      <entry>Array of event configuration properties</entry>
                      <entry>The <code>document_changed</code> event. There is no default. For more information, see the section <ref href="#webhook-event-handler">Webhook event handler</ref>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>maxEventProc</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum concurrent event handling goroutines. The default is <code>500</code>.</entry>
                   </row>
                   <row>
                      <entry>
                         <code>waitForProcess</code>
                      </entry>
                      <entry><code>string</code></entry>
                      <entry>Maximum wait time in milliseconds when the event queue is full. The default is <code>5</code>.</entry>
                   </row>
                </body>
             </table>
                </body>
                </section>
                   <section id="webhook-event-handler">
                      <title>Webhook event handler</title>
                      <body>
                         <paragraph>Following are properties that you can define for a <code>webhook</code> event handler:</paragraph>
                         <table>
                            <header>
                               <row>
                                  <entry>Property</entry>
                                  <entry>Type</entry>
                                  <entry>Description and default</entry>
                               </row>
                            </header>
                            <body> 
                            <row>
                               <entry>
                                  <code>Filter</code>
                               </entry>
                               <entry><code>string</code></entry>
                               <entry>Filter function to determine which documents to post (for a webhook event handler). There is no default.</entry>
                            </row>
                               <row>
                                  <entry>
                                     <code>handlerType</code>
                                  </entry>
                                  <entry><code>string</code></entry>
                                  <entry>Handler type. This must be (<code>webhook</code>). There is no default.</entry>
                               </row>
                               <row>
                                  <entry>
                                     <code>timeout</code>
                                  </entry>
                                  <entry><code>integer</code></entry>
                                  <entry>Timeout in seconds (for a webhook event handler). The default is <code>60</code>.</entry>
                               </row>
                               <row>
                                  <entry>
                                     <code>url</code>
                                  </entry>
                                  <entry><code>string</code></entry>
                                  <entry>URL to which to post documents (for a webhook event handler). There is no default.</entry>
                               </row>
                </body>
             </table>
                         <section id="webhook-example">
                            <title>Examples</title>
                            <body>
                               <paragraph>For examples of webhook configurations, see <ref href="../integration/event-handling.xml#examples-webhooks">Examples</ref>.</paragraph>
                            </body>
                         </section>
                 </body>
                   </section>
                </body>
       </topic>
       
       <topic id="cache-configuration">
          <title>Cache configuration</title>
          <body>
             <paragraph>Following are configuration properties for cache configuration:</paragraph>
             <table>
                <header>
                   <row>
                      <entry>Property</entry>
                      <entry>Type</entry>
                      <entry>Description and default</entry>
                   </row>
                </header>
                <body>
                   <row>
                      <entry>
                         <code>cachePendingSeqMaxNum</code>
                      </entry>
                      <entry><code>integer</code></entry>
                      <entry>Maximum number of pending sequences before skipping the sequence. The default is <code>10000</code>.</entry>
                   </row>
                <row>
                   <entry>
                      <code>cachePendingSeqMaxWait</code>
                   </entry>
                   <entry><code>integer</code></entry>
                   <entry>Maximum wait time in milliseconds for a pending sequence before skipping sequences. The default is <code>5000</code> (five seconds).</entry>
                </row>
                <row>
                   <entry>
                      <code>cacheSkippedSeqMaxWait</code>
                   </entry>
                   <entry><code>integer</code></entry>
                   <entry>Maximum wait time in milliseconds for a skipped sequence before abandoning the sequence. The default is <code>3600000</code> (60 minutes).</entry>
                </row>
                <row>
                   <entry>
                      <code>enableStarChannel</code>
                   </entry>
                   <entry><code>Boolean</code></entry>
                   <entry>Enable the star (*) channel. The default is <code>true</code>.</entry>
                </row>
                </body>
             </table>
          </body>
       </topic>
   </topics>
</article>
